  <!DOCTYPE html>
  <html lang="en">

  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Dashboard - SB Admin</title>
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
      <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
  </head>

  <body class="sb-nav-fixed">
      <nav class="sb-topnav navbar navbar-expand navbar-dark bg-dark">
          <a class="navbar-brand ps-3" href="index.html">Start Bootstrap</a>
      </nav>
      <div id="layoutSidenav">
          <div id="layoutSidenav_nav">
              <nav class="sb-sidenav accordion sb-sidenav-dark" id="sidenavAccordion">
                  <div class="sb-sidenav-menu">
                      <div class="nav">
                          <a class="nav-link" routerLink="/event">Events</a> <!-- Updated link to use routerLink -->
                      </div>
                  </div>
              </nav>
          </div>
          <div id="layoutSidenav_content">
              <main>
                  <div class="container-fluid px-4">
                      <h1 class="mt-4">Gestion des Superviseurs</h1>
                      <div class="card mb-4">
                          <div class="card-body">
                              <!-- Formulaire pour ajouter un superviseur -->
                              <form (ngSubmit)="addSupervisor()" #supervisorForm="ngForm" novalidate>
                                  <div class="form-group">
                                      <label for="name">Nom du Superviseur:</label>
                                      <input type="text" id="name" [(ngModel)]="newSupervisor.name" name="name" class="form-control" required minlength="2">
                                      <div *ngIf="supervisorForm.controls['name']?.invalid && supervisorForm.controls['name']?.touched" class="text-danger">
                                          <small *ngIf="supervisorForm.controls['name']?.errors?.['required']">Le nom est requis.</small>
                                          <small *ngIf="supervisorForm.controls['name']?.errors?.['minlength']">Le nom doit comporter au moins 2 caractères.</small>
                                      </div>
                                  </div>
                                  <div class="form-group">
                                      <label for="email">Email:</label>
                                      <input type="email" id="email" [(ngModel)]="newSupervisor.email" name="email" class="form-control" required email>
                                      <div *ngIf="supervisorForm.controls['email']?.invalid && supervisorForm.controls['email']?.touched" class="text-danger">
                                          <small *ngIf="supervisorForm.controls['email']?.errors?.['required']">L'email est requis.</small>
                                          <small *ngIf="supervisorForm.controls['email']?.errors?.['email']">L'email doit être valide.</small>
                                      </div>
                                  </div>
                                  <button type="submit" class="btn btn-primary" [disabled]="supervisorForm.invalid">Ajouter Superviseur</button>
                              </form>

                              <!-- Liste des superviseurs -->
                              <h3 class="mt-4">Superviseurs</h3>
                              <table class="table">
                                  <thead>
                                      <tr>
                                          <th>Nom</th>
                                          <th>Email</th>
                                          <th>Actions</th>
                                      </tr>
                                  </thead>
                                  <tbody>
                                      <tr *ngFor="let supervisor of supervisors">
                                          <td>{{ supervisor.name }}</td>
                                          <td>{{ supervisor.email }}</td>
                                          <td>
                                              <button (click)="selectSupervisor(supervisor)" class="btn btn-warning btn-sm">Modifier</button>
                                              <button (click)="deleteSupervisor(supervisor.id!)" class="btn btn-danger btn-sm">Supprimer</button>
                                          </td>
                                      </tr>
                                  </tbody>
                              </table>

                              <!-- Formulaire pour modifier un superviseur -->
                              <div *ngIf="editMode && selectedSupervisor" class="mt-4">
                                  <h3>Modifier Superviseur</h3>
                                  <form (ngSubmit)="updateSupervisor()" #editSupervisorForm="ngForm" novalidate>
                                      <div class="form-group">
                                          <label for="editName">Nom:</label>
                                          <input type="text" id="editName" [(ngModel)]="selectedSupervisor.name" name="name" class="form-control" required minlength="2">
                                          <div *ngIf="editSupervisorForm.controls['name']?.invalid && editSupervisorForm.controls['name']?.touched" class="text-danger">
                                              <small *ngIf="editSupervisorForm.controls['name']?.errors?.['required']">Le nom est requis.</small>
                                              <small *ngIf="editSupervisorForm.controls['name']?.errors?.['minlength']">Le nom doit comporter au moins 2 caractères.</small>
                                          </div>
                                      </div>
                                      <div class="form-group">
                                          <label for="editEmail">Email:</label>
                                          <input type="email" id="editEmail" [(ngModel)]="selectedSupervisor.email" name="email" class="form-control" required email>
                                          <div *ngIf="editSupervisorForm.controls['email']?.invalid && editSupervisorForm.controls['email']?.touched" class="text-danger">
                                              <small *ngIf="editSupervisorForm.controls['email']?.errors?.['required']">L'email est requis.</small>
                                              <small *ngIf="editSupervisorForm.controls['email']?.errors?.['email']">L'email doit être valide.</small>
                                          </div>
                                      </div>
                                      <button type="submit" class="btn btn-primary" [disabled]="editSupervisorForm.invalid">Mettre à jour</button>
                                      <button type="button" (click)="cancelEdit()" class="btn btn-secondary">Annuler</button>
                                  </form>
                              </div>

                              <!-- Assigner un étudiant à un superviseur -->
                              <h3 class="mt-4">Assigner un Étudiant à un Superviseur</h3>
                              <div *ngIf="supervisors.length > 0 && etudiants.length > 0">
                                  <div class="form-group">
                                      <label for="supervisorSelect">Superviseur:</label>
                                      <select id="supervisorSelect" [(ngModel)]="selectedSupervisor" class="form-control" required>
                                          <option *ngFor="let supervisor of supervisors" [ngValue]="supervisor">{{ supervisor.name }}</option>
                                      </select>
                                  </div>
                                  <div class="form-group">
                                      <label for="etudiantSelect">Étudiant:</label>
                                      <select id="etudiantSelect" [(ngModel)]="selectedEtudiant" class="form-control" required>
                                          <option *ngFor="let etudiant of etudiants" [ngValue]="etudiant">{{ etudiant.nom }}</option>
                                      </select>
                                  </div>
                                  <button (click)="assignStudent()" class="btn btn-primary" [disabled]="!selectedSupervisor || !selectedEtudiant">Assigner</button>
                                  <div *ngIf="errorMessage" class="text-danger">{{ errorMessage }}</div>
                              </div>

                              <!-- Liste des étudiants assignés avec le nom du superviseur -->
                              <h3 class="mt-4">Étudiants Assignés</h3>
                              <table class="table">
                                  <thead>
                                      <tr>
                                          <th>Nom du Superviseur</th>
                                          <th>Nom de l'Étudiant</th>
                                          <th>Email de l'Étudiant</th>
                                          <th>Actions</th>
                                      </tr>
                                  </thead>
                                  <tbody>
                                      <tr *ngFor="let assignation of assignations">
                                          <td>{{ assignation.supervisor.name }}</td>
                                          <td>{{ assignation.etudiant.nom }}</td>
                                          <td>{{ assignation.etudiant.email }}</td>
                                          <td>
                                              <button (click)="removeStudentFromSupervisor(assignation.supervisor.id!, assignation.etudiant.id!)" class="btn btn-danger btn-sm">Retirer</button>
                                          </td>
                                      </tr>
                                  </tbody>
                              </table>
                          </div>
                      </div>
                  </div>
              </main>
              <footer class="py-4 bg-light mt-auto">
                  <div class="container-fluid px-4">
                      <div class="d-flex align-items-center justify-content-between small">
                          <div class="text-muted">Copyright © Your Website 2023</div>
                          <div>
                              <a href="#">Privacy Policy</a>
                              ·
                              <a href="#">Terms &amp; Conditions</a>
                          </div>
                      </div>
                  </div>
              </footer>
          </div>
      </div>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
  </body>

  </html>