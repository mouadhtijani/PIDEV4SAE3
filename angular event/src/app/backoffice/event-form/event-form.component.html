<div class="container">
  <h2>{{ event.eventId ? 'Modifier l\'événement' : 'Ajouter un nouvel événement' }}</h2>

  <form (ngSubmit)="onSubmit()" #eventForm="ngForm" novalidate>
    <div class="form-group">
      <label for="title">Titre</label>
      <input
        type="text"
        id="title"
        [(ngModel)]="event.title"
        name="title"
        class="form-control"
        required
        minlength="3"
      />
      <div *ngIf="eventForm.controls['title']?.invalid && eventForm.controls['title']?.touched" class="text-danger">
        <small *ngIf="eventForm.controls['title']?.errors?.['required']">Le titre est requis.</small>
        <small *ngIf="eventForm.controls['title']?.errors?.['minlength']">Le titre doit comporter au moins 3 caractères.</small>
      </div>
    </div>

    <div class="form-group">
      <label for="description">Description</label>
      <textarea
        id="description"
        [(ngModel)]="event.description"
        name="description"
        class="form-control"
        required
        minlength="10"
      ></textarea>
      <div *ngIf="eventForm.controls['description']?.invalid && eventForm.controls['description']?.touched" class="text-danger">
        <small *ngIf="eventForm.controls['description']?.errors?.['required']">La description est requise.</small>
        <small *ngIf="eventForm.controls['description']?.errors?.['minlength']">La description doit avoir au moins 10 caractères.</small>
      </div>
    </div>

    <div class="form-group">
      <label for="eventType">Type d'événement</label>
      <select
        id="eventType"
        [(ngModel)]="event.eventType"
        name="eventType"
        class="form-control"
        required
      >
        <option value="CONFERENCE">Conférence</option>
        <option value="WORKSHOP">Atelier</option>
        <option value="WEBINAR">Webinaire</option>
        <option value="HACKATHON">Hackathon</option>
        <option value="NETWORKING">Réseautage</option>
      </select>
      <div *ngIf="eventForm.controls['eventType']?.invalid && eventForm.controls['eventType']?.touched" class="text-danger">
        <small>Le type d'événement est requis.</small>
      </div>
    </div>

    <div class="form-group">
      <label for="category">Catégorie</label>
      <input
        type="text"
        id="category"
        [(ngModel)]="event.category"
        name="category"
        class="form-control"
        required
      />
      <div *ngIf="eventForm.controls['category']?.invalid && eventForm.controls['category']?.touched" class="text-danger">
        <small>La catégorie est requise.</small>
      </div>
    </div>

    <div class="form-group">
      <label for="status">Statut</label>
      <input
        type="text"
        id="status"
        [(ngModel)]="event.status"
        name="status"
        class="form-control"
        required
      />
      <div *ngIf="eventForm.controls['status']?.invalid && eventForm.controls['status']?.touched" class="text-danger">
        <small>Le statut est requis.</small>
      </div>
    </div>

    <div class="form-group">
      <label for="startDate">Date de début</label>
      <input
        type="datetime-local"
        id="startDate"
        [(ngModel)]="event.startDate"
        name="startDate"
        class="form-control"
        required
      />
      <div *ngIf="eventForm.controls['startDate']?.invalid && eventForm.controls['startDate']?.touched" class="text-danger">
        <small>La date de début est requise.</small>
      </div>
    </div>

    <div class="form-group">
      <label for="endDate">Date de fin</label>
      <input
        type="datetime-local"
        id="endDate"
        [(ngModel)]="event.endDate"
        name="endDate"
        class="form-control"
        required
      />
      <div *ngIf="eventForm.controls['endDate']?.invalid && eventForm.controls['endDate']?.touched" class="text-danger">
        <small>La date de fin est requise.</small>
      </div>
    </div>

    <div class="form-group">
      <label for="timezone">Fuseau horaire</label>
      <input
        type="text"
        id="timezone"
        [(ngModel)]="event.timezone"
        name="timezone"
        class="form-control"
        required
      />
      <div *ngIf="eventForm.controls['timezone']?.invalid && eventForm.controls['timezone']?.touched" class="text-danger">
        <small>Le fuseau horaire est requis.</small>
      </div>
    </div>

    <div class="form-group">
      <label for="location">Lieu</label>
      <input
        type="text"
        id="location"
        [(ngModel)]="event.location"
        name="location"
        class="form-control"
        required
      />
      <div *ngIf="eventForm.controls['location']?.invalid && eventForm.controls['location']?.touched" class="text-danger">
        <small>Le lieu est requis.</small>
      </div>
    </div>

    <div class="form-group">
      <label for="maxAttendees">Participants maximum</label>
      <input
        type="number"
        id="maxAttendees"
        [(ngModel)]="event.maxAttendees"
        name="maxAttendees"
        class="form-control"
        required
        min="1"
        max="1000"
      />
      <div *ngIf="eventForm.controls['maxAttendees']?.invalid && eventForm.controls['maxAttendees']?.touched" class="text-danger">
        <small *ngIf="eventForm.controls['maxAttendees']?.errors?.['required']">Le nombre maximum de participants est requis.</small>
        <small *ngIf="eventForm.controls['maxAttendees']?.errors?.['min']">Le nombre doit être au moins 1.</small>
        <small *ngIf="eventForm.controls['maxAttendees']?.errors?.['max']">Le nombre ne peut pas dépasser 1000.</small>
      </div>
    </div>

    <div class="form-group">
      <label for="liveStreamingLink">Lien de streaming en direct</label>
      <input
        type="url"
        id="liveStreamingLink"
        [(ngModel)]="event.liveStreamingLink"
        name="liveStreamingLink"
        class="form-control"
      />
      <div *ngIf="eventForm.controls['liveStreamingLink']?.invalid && eventForm.controls['liveStreamingLink']?.touched" class="text-danger">
        <small>Veuillez saisir une URL valide.</small>
      </div>
    </div>

    <div class="form-check">
      <label for="aiGeneratedAgenda">Agenda IA généré</label>
      <input
        type="checkbox"
        id="aiGeneratedAgenda"
        [(ngModel)]="event.aiGeneratedAgenda"
        name="aiGeneratedAgenda"
        class="form-check-input"
      />
    </div>

    <div class="form-check">
      <label for="chatbotEnabled">Chatbot activé</label>
      <input
        type="checkbox"
        id="chatbotEnabled"
        [(ngModel)]="event.chatbotEnabled"
        name="chatbotEnabled"
        class="form-check-input"
      />
    </div>
    <div class="form-group">
      <label for="latitude">Latitude</label>
      <input
        type="number"
        id="latitude"
        [(ngModel)]="event.latitude"
        name="latitude"
        class="form-control"
        step="any"
        required
      />
      <div *ngIf="eventForm.controls['latitude']?.invalid && eventForm.controls['latitude']?.touched" class="text-danger">
        <small>La latitude est requise.</small>
      </div>
    </div>
    
    <div class="form-group">
      <label for="longitude">Longitude</label>
      <input
        type="number"
        id="longitude"
        [(ngModel)]="event.longitude"
        name="longitude"
        class="form-control"
        step="any"
        required
      />
      <div *ngIf="eventForm.controls['longitude']?.invalid && eventForm.controls['longitude']?.touched" class="text-danger">
        <small>La longitude est requise.</small>
      </div>
    </div>
    

    <button type="submit" class="btn btn-primary" [disabled]="eventForm.invalid">
      {{ event.eventId ? 'Mettre à jour' : 'Ajouter' }}
    </button>
    <button type="button" (click)="resetForm()" class="btn btn-secondary">Réinitialiser</button>
    <!-- Button to navigate to event list page -->
    <a routerLink="/event" class="btn btn-secondary mt-3">Voir la liste des événements</a>
  </form>
</div>